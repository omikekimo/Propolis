extends layout

block content
  // Your existing content here
  
  // Worklife Content Section
  section#worklife-content
    h2 Worklife Dashboard
    button#create-enterprise-button Create New Enterprise

    // Add a form for registering a new enterprise (hidden initially)
    form#create-enterprise-form(style='display:none;')
      label(for='enterprise-name') Enterprise Name:
      input#enterprise-name(type='text', name='enterprise-name')
      button#submit-enterprise-button(type='submit') Submit
      button#cancel-enterprise-button(type='button') Cancel

  // JavaScript to handle form submission and button click events
  script.
    const createEnterpriseButton = document.querySelector('#create-enterprise-button');
    const createEnterpriseForm = document.querySelector('#create-enterprise-form');
    const cancelEnterpriseButton = document.querySelector('#cancel-enterprise-button');

    createEnterpriseButton.addEventListener('click', () => {
      createEnterpriseButton.style.display = 'none';
      createEnterpriseForm.style.display = 'block';
    });

    cancelEnterpriseButton.addEventListener('click', () => {
      createEnterpriseButton.style.display = 'block';
      createEnterpriseForm.style.display = 'none';
      enterpriseNameInput.value = ''; // Clear input field
    });

    const submitEnterpriseButton = document.querySelector('#submit-enterprise-button');
    const enterpriseNameInput = document.querySelector('#enterprise-name');

    submitEnterpriseButton.addEventListener('click', (event) => {
      event.preventDefault(); // Prevent default form submission

      const enterpriseName = enterpriseNameInput.value;

      // Check if enterprise name is provided
      if (!enterpriseName) {
        alert('Please enter an enterprise name');
        return;
      }

      // Perform AJAX request to submit form data
      fetch('/worklife', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ enterpriseName }),
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        // Reset the form and hide it
        createEnterpriseButton.style.display = 'block';
        createEnterpriseForm.style.display = 'none';
        enterpriseNameInput.value = ''; // Clear input field
        alert('Enterprise created successfully');
      })
      .catch(error => {
        console.error('There was a problem with the fetch operation:', error);
        alert('An error occurred while creating the enterprise');
      });
    });

